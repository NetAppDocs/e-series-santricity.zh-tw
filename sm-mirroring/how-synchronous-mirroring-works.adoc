---
permalink: sm-mirroring/how-synchronous-mirroring-works.html 
sidebar: sidebar 
keywords: SANtricity, System Manager, E-Series, synchronous, mirroring, 
summary: 同步鏡射可即時複寫資料磁碟區、確保持續可用。 
---
= 同步鏡射的運作方式
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
同步鏡射可即時複寫資料磁碟區、確保持續可用。

[NOTE]
====
EF600 或 EF300 儲存陣列不提供同步鏡射功能。

====
同步鏡射可在兩個儲存陣列的其中一個發生災難時、提供重要資料的複本、藉此達到零遺失資料的還原點目標（RPO）。複本會在每一刻與正式作業資料完全相同、因為每次寫入主要磁碟區時、都會寫入次要磁碟區。在次要Volume成功更新為主要Volume所做的變更之前、主機不會收到寫入成功的確認訊息。

這類鏡射是業務持續運作（例如災難恢復）的理想選擇。



== 同步鏡射關係

同步鏡射關係是由主磁碟區和獨立儲存陣列上的次要磁碟區所組成。包含主磁碟區的儲存陣列通常位於主站台、並為作用中主機提供服務。包含次要磁碟區的儲存陣列通常位於次要站台、並擁有資料的複本。如果主要磁碟區的儲存陣列因為完全停電、火災或主要站台的硬體故障而無法使用、則會使用次要磁碟區。



== 同步鏡射工作階段

同步鏡射組態程序涉及將磁碟區組態為成對。建立鏡射配對（由一個儲存陣列上的主要磁碟區和另一個儲存陣列上的次要磁碟區組成）之後、即可啟動同步鏡射。同步鏡射的步驟如下所示。

image::../media/sam-1130-dwg-sync-mirroring-session.gif[Sam 1130dwg-同步鏡射工作階段]

. 寫入來自主機。
. 寫入作業會提交至主要磁碟區、傳播至遠端系統、然後提交至次要磁碟區。
. 主磁碟區的儲存陣列會在成功完成兩個寫入作業後、將I/O完成訊息傳送至主機系統_after。


保留容量用於記錄來自主機的傳入寫入要求相關資訊。

當主要磁碟區的目前控制器擁有者收到來自主機的寫入要求時、控制器會先將有關寫入的資訊記錄到主要磁碟區的保留容量。然後將資料寫入主磁碟區。接下來、控制器會啟動遠端寫入作業、將受影響的資料區塊複製到遠端儲存陣列的次要磁碟區。

因為主機應用程式必須等待本機儲存陣列和遠端儲存陣列的網路上發生寫入、 本機儲存陣列與遠端儲存陣列之間必須有非常快速的連線、才能維持鏡射關係、而不會過度降低本機I/O效能。



== 災難恢復

同步鏡射會維護資料複本、該複本與資料所在的站台實體距離較遠。如果主站台發生災難、例如停電或水災、則可從次站台快速存取資料。

同步鏡射作業進行期間、次要Volume無法裝載應用程式、因此當本機儲存陣列發生災難時、您可以容錯移轉至遠端儲存陣列。若要容錯移轉、請將次要Volume升級為主要角色。然後恢復主機就能存取新升級的磁碟區、業務作業也能繼續進行。



== 同步處理設定

建立鏡射配對時、您也可以定義同步優先順序和重新同步原則、鏡射配對會在通訊中斷後、用來完成重新同步作業。

如果兩個儲存陣列之間的通訊連結停止運作、則主機會繼續收到本機儲存陣列的確認訊息、以避免存取遺失。當通訊連結再次運作時、任何未複寫的資料都可以自動或手動重新同步到遠端儲存陣列。

資料是否自動重新同步取決於鏡射配對的重新同步原則。自動重新同步原則可讓鏡射配對在連結再次運作時自動重新同步。手動重新同步原則要求您在發生通訊問題後手動恢復同步。建議使用手動重新同步原則。

您只能在包含主Volume的儲存陣列上編輯鏡射配對的同步設定。



== 非同步化資料

當主要磁碟區的儲存陣列無法將資料寫入次要磁碟區時、主要和次要磁碟區會變成不同步。這可能是因為下列問題所造成：

* 本機與遠端儲存陣列之間的網路問題
* 故障的次要Volume
* 正在鏡射配對上手動暫停同步




== 孤立的鏡射配對

當某個成員磁碟區已從一端移除（主端或次要端）、但未在另一端移除時、就會出現孤立的鏡射配對磁碟區。

當陣列間通訊恢復且鏡射組態協調鏡射參數的兩側時、就會偵測到孤立的鏡射配對磁碟區。

您可以移除鏡射配對、以修正孤立的鏡射配對狀態。



== 組態與管理

若要在兩個陣列之間啟用及設定鏡射、您必須使用Unified Manager介面。啟用鏡射之後、您就可以在System Manager中管理鏡射配對和同步設定。
